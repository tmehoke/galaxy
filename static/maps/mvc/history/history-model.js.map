{"version":3,"file":"history-model.js","sources":["../../../src/mvc/history/history-model.js"],"names":["define","HISTORY_CONTENTS","UTILS","BASE_MVC","History","Backbone","Model","extend","LoggableMixin","mixin","SearchableModelMixin","defaults","model_class","id","name","state","diskSize","deleted","urlRoot","galaxy_config","root","initialize","historyJSON","contentsJSON","options","this","logger","log","contents","HistoryContents","historyId","get","_setUpListeners","updateTimeoutId","on","model","xhr","msg","details","errorHandler","listenTo","trigger","apply","concat","jQuery","makeArray","arguments","newId","clearUpdateTimeout","nice_size","bytesToString","toJSON","_","prototype","call","key","ownedByCurrUser","Galaxy","currUser","isAnonymous","contentsCount","reduce","values","memo","num","searchAttributes","searchAliases","title","tag","checkForUpdates","onReadyCallback","running","length","setUpdateTimeout","isFunction","delay","UPDATE_DELAY","history","setTimeout","refresh","clearTimeout","detailIds","data","join","fetch","done","_delete","when","save","purge","purged","undelete","copy","current","allDatasets","undefined","Error","postData","history_id","all_datasets","post","then","response","newHistory","setAsCurrent","getJSON","toString","getHistoryData","getHistory","ajax","isEmpty","historyData","empty","getContents","detailIdsFn","hdcaDetailIds","dataset_details","dataset_collection_details","df","Deferred","historyFn","contentsFn","historyXHR","json","notify","status","fail","reject","contentsXHR","resolve","ControlledFetchMixin","_buildFetchData","traditional","Collection","_fetchOptions","fetchDefaults","_fetchDefaults","pick","filters","has","_buildFetchFilters","filterMap","q","qv","each","v","k","push","HistoryCollection","DEFAULT_ORDER","sortOrders","update_time","getter","h","Date","asc","update_time-asc","name-dsc","size","size-asc","models","includeDeleted","setOrder","order","currentHistoryId","allFetched","setUpListeners","window","url","view","change:deleted","debug","remove","copied","original","newData","setCurrent","set-as-current","oldCurrentId","sort","collection","sortOrder","isUndefined","comparator","a","b","fetchOptions","offset","limit","fetchData","numFetched","isArray","create","hdas","historyOptions","unshift","silent","reset"],"mappings":"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"}