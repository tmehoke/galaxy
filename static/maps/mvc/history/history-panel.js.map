{"version":3,"file":"history-panel.js","sources":["../../../src/mvc/history/history-panel.js"],"names":["define","LIST_PANEL","HISTORY_MODEL","HISTORY_CONTENTS","HDA_LI","HDCA_LI","COLLECTION_PANEL","USER","faIconButton","PopupMenu","BASE_MVC","_l","HistoryPrefs","SessionStorageModel","extend","defaults","expandedIds","show_deleted","show_hidden","addExpanded","model","key","this","save","_","get","object","id","removeExpanded","omit","toString","storageKeyPrefix","historyStorageKey","historyId","Error","clearAll","sessionStorage","indexOf","removeItem","_super","ModelListPanel","HistoryPanel","HDAViewClass","HDAListItemView","HDCAViewClass","HDCAListItemView","collectionClass","HistoryContents","modelCollectionKey","tagName","className","prototype","emptyMsg","noneFoundMsg","searchPlaceholder","initialize","attributes","call","linkTarget","freeModel","clearUpdateTimeout","_setUpListeners","on","error","xhr","options","msg","details","errorHandler","loading-done","views","length","trigger","views:ready view:attached view:removed","_renderSelectButton","loadHistoryWithDetails","historyFn","contentsFn","info","detailIdsFn","historyData","values","loadHistory","panel","History","getHistoryData","initiallyExpanded","_loadHistoryFromXHR","fail","where","history","always","then","historyJSON","contentsJSON","JSONToModel","render","refreshContents","detailIds","refresh","$","when","newHistoryJSON","newHdaJSON","log","setModel","_setUpWebStorage","storage","stopListening","isObject","set","isBoolean","listenTo","change:show_deleted","view","newVal","showDeleted","change:show_hidden","showHidden","undefined","_buildNewRender","$newRender","$where","$el","multiselectActions","hideSelectors","find","remove","$existing","size","title","classes","faIcon","prependTo","_getItemViewClass","contentType","TypeError","_filterItem","hidden","isDeletedOrPurged","_getItemViewOptions","expanded","hasUser","ownedByCurrUser","_setUpItemViewListeners","v","getSelectedModels","collection","events","clone","click .show-selectors-btn","click .messages [class$=message]","toggleShowDeleted","show","store","renderItems","toggleShowHidden","_firstSearch","searchFor","inputSelector","contents","haveDetails","searchItems","searchInput","fetchAllDetails","silent","done","status","readyState","parsed","_parseErrorMessage","$messages","is","displayMessage","message","once","user","Galaxy","currUser","_bePolite","raven","window","Raven","isFunction","lastEventId","agent","navigator","userAgent","url","lastAjax","data","source","toJSON","User","getAllResponseHeaders","responseHeaders","compact","split","map","header","type","scrollToTop","$msgContainer","$msg","addClass","html","isEmpty","$detailsLink","click","modal","_messageToModalOptions","append","functions","text","JSON","stringify","pre","body","buttons","Ok","hide","clearMessages","ev","$target","isUndefined","children","currentTarget","fadeOut","fxSpeed","scrollToHid","hid","scrollToItem","first","viewsWhereModel","templates","controlsTemplate","wrapTemplate","controls"],"mappings":"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"}